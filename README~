Sudoku3
========================
09/06/2011 Warsaw
Start to port Sudoku from rails 2 to rails 3

Create application from the template on https://github.com/railsapps/rails3-mongoid-devise, 

rails g scaffold Puzzle level:integer name:string description:text

10/06/2011 Warsaw
Make the first cucumber of Puzzle passed

To support database migration, a change needs to be made to the file config/application.rb to disperse the error
mongoid error
create a migrate to database and rspec it
//obsolete above, mongoid is different in the database migration than ActiveRecord

follow the introduction on http://asciicasts.com/episodes/238-mongoid
change the model directly, add the validate_presence_of :name, to the model and modify spec/../puzzle_controller_spec.rb valid_attributes accordingly
then rake spec passed

So far a skeleton of BDD has been built for rails program.

17/06/2011 Warsaw
Make compass worked. Compass 0.11 branch + Rails 3.1 RC4 need a lot of hacks.

17/06/2011 Warsaw
Create model Sudokus

E:\Workspace\sudoku31>rails g model Sudoku puzzle:reference
      invoke  mongoid
      create    app/models/sudoku.rb
      invoke    rspec
      create      spec/models/sudoku_spec.rb

E:\Workspace\sudoku31>rails g controller sudokus
      create  app/controllers/sudokus_controller.rb
      invoke  haml
      create    app/views/sudokus (remove it)
      invoke  rspec
      create    spec/controllers/sudokus_controller_spec.rb
      invoke  helper
      create    app/helpers/sudokus_helper.rb
      invoke    rspec
      invoke  assets
      create    app/assets/javascripts/sudokus.js.coffee (remove it)
      invoke    scss
      create      app/assets/stylesheets/sudokus.css.scss (remove it)

23/06/2011 Prague
Started to port it rails3.1, it is very painful especially to get compass working!
Issue 1: Coffee Script to understand regular express. It is different than javascript
e.g. new RegExp("string", "g") works well in Javascript but in Coffee it converts it automatically to /string\/g
Don't yet how to fix it.

update
simply fixed it by set pattern.global = true (not mentioned in any document, discovered it when debuging to explore pattern)
It should be wrong!!! because pattern.global is readonly.

24/06/2011 Prague
Issue1: editable cell fixed size. Fixed it by set CSS table-layout and word-wrap

29/06/2011 Prague
To do list:
1.Port create sudokus table from JS to CS 
2.Fix the ul.hmenu (fixed it by set application.css.scss)
3.Beautify the form
4.I18N

if i define newCellCSS with font {}, even I use tdNode.removeClass().addClass('newFontCSS'), it will not change the size at all
finally find out the root cause (get rid of font define inside td css) and remove css code in programe. 
the same thing to background, background-color

29/06/2011 Prague
unexpected INDENT error raised by Coffeescript compiler. check carefully for the for loop, if a new line is not the part of the for loop, there should be a blank line

03/07/2011 Warsaw
Done porting create table from JS to CS. Though I prefer to do it in the similar way done in the JS (backup/grid.sudoku), this way is simple but less straightforward.
When using jQuery to append, needs to be very careful to use the right selector $('#tbl'), otherwise no grid created by $('tbl')
To do list:
1. Port string.sudoku.js to CS
2. I18N
3. Finish all puzzles view
4. Solution to puzzles
5. JS test under cabybara

It might be better to create a help system to track all I have done for the developing. Will be funny.

04/07/2011 Warsaw
define a step for select in web_steps.rb then level (select box) now get supported in cucumber
just don't know why it has not been defined from the beginning, since it is so common?

07/07/2011 Warsaw
It likes a little bit hack to make capybara go!
Cellstring is a hidden field, to set its value I need to create a new web step "...set hidden value...", and pass the name with ugly parameter puzzle[cellstring].
tried selenium, but failed to find good document to guide me through
!!! Successfully to set validate and make cucumber & rspec passed!
JS testing still needs to be studied.
To do list:
1. Pagination
2. I18N
3. Puzzles View
4. Solution to puzzles
5. JS test
6. Modify puzzle model to reflect who created it and when
7. (both server and JS side) check a puzzle if it can be fixed by program automatically. If not, return it to creator and ask he/she mark the level as **** (level 4)

When get text from DOM, sometimes there will be space/newline at the end of the string, be VERY carefully to compare with another string!!! It takes me a few hours to fixed it by add jQuery.trim to remove all spaces and new line!!!

14/07/2011 Warsaw
finished porting sudoku.js to coffescript. There are a lot of problems have been fixed. But finally I am here.

15/07/2011 Warsaw
Added AJAX update puzzle grid over the click to the list. By call jQuery.get(.json, ...)
Added support for will_paginate, remember to restart server when change gemfile

22/08/2011 Warsaw
Ported to rails 3.1 rc6/ubuntu. 
#1: refer to http://metaskills.net/2011/07/29/use-compass-sass-framework-files-with-the-rails-3.1.0.rc5-asset-pipeline/
#2: added one line to Gemfile for 'therubyracer' to let coffeesciprt works!!!

29/08/2011 Vienna
To do list
1. Push to heroku
2. I18N
3. more puzzles to seeds.txt
4. Cancan - let user can only manipulate his/her own stuff

07/10/2011 Shenzhen
Rails 3.1 is out, port sudoku31 rails 31
* restruct Gemfile
* edit config/initializers/saas.rb to add one line to 
  config.load_paths << "#{Gem.loaded_specs['compass'].full_gem_path}/frameworks/blueprint/stylesheets"
* No one tell me that, debug it from the error message
the guide below tells me that no hack needs, it is not right.
http://metaskills.net/2011/05/18/use-compass-sass-framework-files-with-the-rails-3.1-asset-pipeline/

To do list
1. Html5  http://hlee.iteye.com/blog/1175506

15/10/2011 Shenzhen
push to heroku
francois_cai@hotmail.com/...s
github: francois_cai@hotmail.com/......O

http://ruby.railstutorial.org/ruby-on-rails-tutorial-book#sec:github

0. gem install heroku, heroku keys:add ...
1. heroku create opensudo --stack cedar
2. git push heroku master

To do list
1. Html5  http://hlee.iteye.com/blog/1175506


16/10/2011 Shenzhen
yesterday upgrade system to ubuntu 11.10 after 10+ hours. And I was shocked to see my PC kept rebooting to do memtest86 in the morning.
I firstly think it failed to upgrade. So I used a 10.04 usb-harddisk to try to rescue it. And it became worse and said that "symbol cannot be found, grub_putchar". The reason I guess it is the difference between grub and grub2
Then I used a DOS boot CD to boot my PC and restore C: by ghost and then fdisk/mbr make windows bootable and fortunately the Grub4dos which I installed before worked well.
Then use 11.04 iso to rescue grub2. the first error appeared again. 
Then I googled the error message and in one similar serie to say that if no bootable menu appeared, you can press shift to see grub menu. Yes, I did that and the menu was there. And I ran into the first one 11.10 but another error came out: when I open firefox I just see a white screen. I guess it is the problem of 3D and it is. fix it by login into 2D.

16/10/2011 Shenzhen
now sudoku31 can run on heroku ->
* verify account to install mongohq:free(heroku addons:add mongohq:free)
* modify config/mongoid.yml, change production's setup
http://saberma.me/rails/2010/12/23/deploy-rails-app-to-heroku-and-use-mongohq.html
* heroku create opensudo -s cedar
* needs to modify gemfile about "therubyracer" to development, for cedar already have V8 engine embed
* heroku run rake db:seed
________________________

________________________

License

Copyright 2011 Qingfeng Cai All rights reserved

